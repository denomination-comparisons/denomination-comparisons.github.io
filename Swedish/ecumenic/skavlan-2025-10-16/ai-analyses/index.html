<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Analyses Index</title>
<style>
  body { font-family: system-ui, sans-serif; margin: 2rem; background: #fafafa; color: #222; }
  h1 { font-size: 1.6rem; }
  ul { list-style: none; padding: 0; }
  li { margin: 0.4rem 0; }
  a { color: #0059b3; text-decoration: none; }
  a:hover { text-decoration: underline; }
  pre, article { background: #fff; padding: 1rem; border-radius: 0.6rem; box-shadow: 0 0 4px #ccc; margin-top: 1rem; overflow-x: auto; }
  #content { margin-top: 2rem; }
</style>
</head>
<body>
<h1>AI Analyses</h1>
<p>Files from <code>Swedish/ecumenic/skavlan-2025-10-16/ai-analyses/</code></p>
<ul id="file-list"><li>Loading filesâ€¦</li></ul>

<div id="content"><em>Select a file to view its content.</em></div>

<script>
const owner = "denomination-comparisons";
const repo = "denomination-comparisons.github.io";
const folderPath = "Swedish/ecumenic/skavlan-2025-10-16/ai-analyses";

const fileList = document.getElementById("file-list");
const contentDiv = document.getElementById("content");

fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${folderPath}`)
  .then(res => res.json())
  .then(files => {
    const validFiles = files.filter(f => /\.(md|json|txt)$/i.test(f.name));
    if (validFiles.length === 0) {
      fileList.innerHTML = "<li>No .md, .json, or .txt files found.</li>";
      return;
    }
    fileList.innerHTML = "";
    validFiles.forEach(f => {
      const li = document.createElement("li");
      const a = document.createElement("a");
      a.href = "#";
      a.textContent = f.name;
      a.onclick = async (e) => {
        e.preventDefault();
        const rawUrl = f.download_url;
        const resp = await fetch(rawUrl);
        const text = await resp.text();
        contentDiv.innerHTML = `<h2>${f.name}</h2><article>${render(text, f.name)}</article>`;
      };
      li.appendChild(a);
      fileList.appendChild(li);
    });
  })
  .catch(err => {
    console.error(err);
    fileList.innerHTML = "<li>Error loading file list.</li>";
  });

function render(text, filename) {
  if (filename.endsWith(".json")) {
    try { return "<pre>" + JSON.stringify(JSON.parse(text), null, 2) + "</pre>"; }
    catch { return "<pre>" + text + "</pre>"; }
  }
  if (filename.endsWith(".md")) {
    // Simple Markdown render (minimal)
    return text
      .replace(/^### (.*$)/gim, '<h3>$1</h3>')
      .replace(/^## (.*$)/gim, '<h2>$1</h2>')
      .replace(/^# (.*$)/gim, '<h1>$1</h1>')
      .replace(/\*\*(.*?)\*\*/gim, '<b>$1</b>')
      .replace(/\*(.*?)\*/gim, '<i>$1</i>')
      .replace(/\n/g, '<br>');
  }
  return "<pre>" + text + "</pre>";
}
</script>
</body>
</html>
